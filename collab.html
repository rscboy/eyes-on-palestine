<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/197/197467.png" type="image/png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Echoes of Gaza - Submission Form</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom Styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #121212; /* Dark background */
            color: #E0E0E0; /* Light text */
        }
        .form-container {
            background-color: #1E1E1E; /* Dark card background */
            border: 1px solid #333;
            border-top: 4px solid #D90000; /* Red accent */
        }
        .form-input, .form-select {
            background-color: #2C2C2C;
            border: 1px solid #444;
            color: #FFFFFF;
            border-radius: 0.375rem; /* rounded-md */
        }
        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #D90000; /* Red focus */
            box-shadow: 0 0 0 2px #5a0000;
        }
        .btn-submit {
            background-color: #008000; /* Green */
            color: #FFFFFF;
            transition: background-color 0.3s ease;
        }
        .btn-submit:hover {
            background-color: #006400; /* Darker green */
        }
        .btn-submit:disabled {
            background-color: #444;
            cursor: not-allowed;
        }
        .title-green {
            color: #008000;
        }
        .title-white {
            color: #FFFFFF;
        }
        .title-red {
            color: #D90000;
        }
        .subtitle-gray {
            color: #AAAAAA;
        }
        .note-block {
            background-color: #2C2C2C;
            border-left: 4px solid #D90000;
            padding: 0.75rem;
            border-radius: 0.25rem;
        }
        /* Success and Error Message Styles */
        .alert-message {
            display: none; /* Hidden by default */
            padding: 0.75rem 1rem;
            border-radius: 0.375rem;
            margin-bottom: 1rem;
            text-align: center;
            font-weight: 500;
        }
        .alert-success {
            background-color: #004d00; /* Dark green */
            color: #90ee90; /* Light green text */
            border: 1px solid #008000;
        }
        .alert-error {
            background-color: #4d0000; /* Dark red */
            color: #f08080; /* Light red text */
            border: 1px solid #D90000;
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-2xl mx-auto">
        <!-- Header -->
        <div class="mb-6">
            <h1 class="text-3xl font-bold">
                <span class="title-green">Echoes</span>
                <span class="title-white">of</span>
                <span class="title-red">Gaza</span>:
                <span class="text-2xl font-medium subtitle-gray">a historical archive</span>
            </h1>
        </div>

        <!-- Form Card -->
        <div class="form-container shadow-lg rounded-lg p-6 md:p-8">
            <div class="space-y-6">
                <!-- Introduction Text -->
                <div>
                    <p class="text-gray-300 mb-4">
                        This is a Gaza genocide collaborative. Submit articles that document the ongoing genocide, ethnic cleansing, displacement, dehumanization, and subjugation of the Palestinian people.
                    </p>
                    <div class="note-block text-sm text-gray-400">
                        <p class="font-semibold text-gray-200 mb-2">Note on Contribution</p>
                        <p>
                            This is an open-source project. Contributions are curated from individuals invited to the collective based on a history of acting in good faith toward Palestinian liberation. All submissions will be reviewed to ensure they align with the mission of Echoes of Gaza.
                        </p>
                    </div>
                </div>

                <!-- Form -->
                <form id="submissionForm" class="space-y-4">
                    
                    <!-- Required Fields -->
                    <div>
                        <h3 class="text-lg font-semibold mb-3 border-b border-gray-600 pb-2 text-gray-200">Required Information</h3>
                        <div class="space-y-4">
                            <div>
                                <label for="submitterName" class="block text-sm font-medium text-gray-300 mb-1">Your Name *</label>
                                <input type="text" id="submitterName" name="submitterName" class="form-input block w-full p-2" placeholder="So we know who sent this" required>
                            </div>
                            <div>
                                <label for="date" class="block text-sm font-medium text-gray-300 mb-1">Date of Article (YYYY-MM-DD) *</label>
                                <input type="date" id="date" name="date" class="form-input block w-full p-2" required>
                            </div>
                            <div>
                                <label for="title" class="block text-sm font-medium text-gray-300 mb-1">Article Title *</label>
                                <input type="text" id="title" name="title" class="form-input block w-full p-2" placeholder="The exact title of the article" required>
                            </div>
                            <div>
                                <label for="link" class="block text-sm font-medium text-gray-300 mb-1">Article URL *</label>
                                <input type="url" id="link" name="link" class="form-input block w-full p-2" placeholder="https://..." required>
                            </div>
                            <div>
                                <label for="source" class="block text-sm font-medium text-gray-300 mb-1">Source Name *</label>
                                <input type="text" id="source" name="source" class="form-input block w-full p-2" placeholder="e.g., Al Jazeera, The Guardian, +972 Magazine" required>
                            </div>
                            <div>
                                <label for="category" class="block text-sm font-medium text-gray-300 mb-1">Category *</label>
                                <select id="category" name="category" class="form-select block w-full p-2" required>
                                    <option value="" disabled selected>Select a category</option>
                                    <!-- Categories will be populated by JavaScript -->
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Optional Fields -->
                    <div>
                        <h3 class="text-lg font-semibold mb-3 border-b border-gray-600 pb-2 text-gray-200">Optional Information</h3>
                        <div class="space-y-4">
                            <div>
                                <label for="summary" class="block text-sm font-medium text-gray-300 mb-1">Neutral Summary (Optional)</label>
                                <textarea id="summary" name="summary" rows="4" class="form-input block w-full p-2" placeholder="A brief, neutral, one or two-sentence summary of the article's content."></textarea>
                            </div>
                            <div>
                                <label for="imageUrl" class="block text-sm font-medium text-gray-300 mb-1">Image URL (Optional)</label>
                                <input type="url" id="imageUrl" name="imageUrl" class="form-input block w-full p-2" placeholder="A link to a relevant image (if available)">
                            </div>
                        </div>
                    </div>

                    <!-- Submit Button & Messages -->
                    <div>
                        <!-- Submission Status Messages -->
                        <div id="successMessage" class="alert-message alert-success">
                            Thank you! Your submission has been received.
                        </div>
                        <div id="errorMessage" class="alert-message alert-error">
                            Oops! Something went wrong. Please try again.
                        </div>

                        <button type="button" id="submitButton" class="btn-submit w-full font-bold py-2 px-4 rounded-md shadow-md">
                            Submit Article
                        </button>
                        <p id="submittingText" class="text-xs text-center text-gray-500 mt-3" style="display: none;">
                            Submitting, please wait...
                        </p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // List of all categories, cleaned and sorted
        const categories = [
            "Accountability", "Aid Access", "Aid blockade", "Aid conflict", "Aid crisis",
            "Aid disaster", "Aid Disruption", "Aid policy", "Aid Targeting", "Analysis",
            "Antisemitism", "Civilian Casualties", "Conflict", "Conflict / Human Stories",
            "Conflict / Humanitarian", "Conflict and Destruction", "Conflict and Displacement",
            "Conflict escalation", "Conflict Reporting", "Crisis", "Culture", "Death Toll",
            "Destruction Plans", "Detention & Rights", "Diplomacy", "Economic Crisis",
            "Environment", "Ethnic Cleansing", "Extreme Rhetoric", "Famine crisis",
            "Forced Displacement", "Foreign Policy", "Gaza Policy", "Genocide",
            "Genocide Accusations", "Genocide Allegation", "Genocide Allegations",
            "Genocide Analysis", "Health", "Health / Starvation", "Healthcare Crisis",
            "Hostage Testimony", "Human interest", "Human Rights", "Human Shields",
            "Humanitarian", "Humanitarian Aid", "Humanitarian Crisis", "Humanitarian aid",
            "Hunger Crisis", "Illegal Expansion", "Illegal Weaponry", "Incitement",
            "Intelligence", "International Appeal", "Israeli Politics", "Legal",
            "Legal Proceedings", "Living Conditions", "Media", "Media & Conflict",
            "Media Coverage", "Media Restrictions", "Media Rights", "Media ethics",
            "Medical Testimony", "Military", "Military Criticism", "Military Operations",
            "Military Plans", "Military Technology", "Military policy", "Opinion",
            "Opinion / Human Rights", "Political Controversy", "Political Criticism",
            "Political Discourse", "Political Statements", "Politics", "Press Freedom",
            "Press freedom", "Prison Conditions", "Protests", "Psychological Warfare",
            "Public Opinion",
            "Rhetoric", "Rights & Justice", "Rules of Engagement",
            "Security / Diplomacy", "Settler Violence", "Sexual Violence", "Social Impact",
            "Sports", "Sports & Conflict", "Starvation", "Starvation Warning",
            "Targeting Civilians", "Targeting Healthcare", "Targeting Religious Sites",
            "Technology", "Transfer Support", "U.S. Politics", "UN Reports", "UN Warnings",
            "War Crimes", "War Objectives", "West Bank Violence", "analysis", "conflict",
            "diplomacy", "human rights", "humanitarian crisis"
        ].sort();

        // Populate category dropdown
        const categorySelect = document.getElementById('category');
        categories.forEach(category => {
            const option = document.createElement('option');
            option.value = category;
            option.textContent = category;
            categorySelect.appendChild(option);
        });

        // Color palette for categories (17 colors)
        const colors = [
            "#FF6B6B", "#4ECDC4", "#45B7D1", "#F9C80E", "#FF8811",
            "#F0E68C", "#98D8C8", "#B5EAD7", "#FFB7B2", "#77DD77",
            "#A2D2FF", "#C7CEEA", "#F3A683", "#F194B4", "#83D6E3",
            "#E0BBE4", "#D6EAF8"
        ];

        /**
         * Simple hash function to get a consistent index from a string.
         */
        function simpleHash(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash; // Convert to 32bit integer
            }
            return Math.abs(hash);
        }

        /**
         * Gets a consistent color from the palette based on the category name.
         */
        function getCategoryColor(category) {
            const hash = simpleHash(category);
            const index = hash % colors.length;
            return colors[index];
        }

        // Get form elements
        const form = document.getElementById('submissionForm');
        const submitButton = document.getElementById('submitButton');
        const submittingText = document.getElementById('submittingText');
        const successMessage = document.getElementById('successMessage');
        const errorMessage = document.getElementById('errorMessage');

        // Handle form submission
        submitButton.addEventListener('click', function(event) {
            // Manually check validity
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            // Disable button and show loading text
            submitButton.disabled = true;
            submittingText.style.display = 'block';
            successMessage.style.display = 'none';
            errorMessage.style.display = 'none';

            // Get form data
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());

            // Get the assigned color
            const categoryColor = getCategoryColor(data.category);

            // Create JSON object for the Google Script
            const jsonObject = {
                submitted_by: data.submitterName,
                date: data.date,
                title: data.title,
                summary: data.summary || "",
                link: data.link,
                imageUrl: data.imageUrl || "https://placehold.co/600x400/2C2C2C/E0E0E0?text=No+Image",
                category: data.category,
                categoryColor: categoryColor,
                source: data.source
            };

            // --- THIS IS THE UPDATED PART ---
            // Your Google Apps Script Web App URL
            const googleScriptWebAppUrl = 'https://script.google.com/macros/s/AKfycbyBnG6OCnoSwDea9fad4v6I2nx-7ioDa9uXCOY_0dbc6mmMcL5Nmiee7600fC4iH3Dj/exec';

            fetch(googleScriptWebAppUrl, {
                method: 'POST',
                // We send as text/plain, which Google Apps Script
                // will receive in e.postData.contents
                headers: {
                    'Content-Type': 'text/plain;charset=utf-8', 
                },
                body: JSON.stringify(jsonObject) // Send the JSON object as a string
            })
            .then(response => response.json()) // Google Script returns JSON
            .then(data => {
                if (data.result === 'success') {
                    // Show success
                    successMessage.style.display = 'block';
                    form.reset();
                } else {
                    // Show error
                    errorMessage.style.display = 'block';
                }
            })
            .catch(error => {
                // Show error
                console.error('Fetch Error:', error);
                errorMessage.style.display = 'block';
            })
            .finally(() => {
                // Re-enable button and hide loading text
                submitButton.disabled = false;
                submittingText.style.display = 'none';
            });
        });
    </script>
</body>
</html>


