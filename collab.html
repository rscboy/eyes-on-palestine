<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Submit to Echoes of Gaza</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for dark theme form elements */
        .form-input, .form-select {
            background-color: #1a202c; /* gray-800 */
            border-color: #4a5568; /* gray-600 */
            color: #e2e8f0; /* gray-200 */
        }
        .form-input:focus, .form-select:focus {
            background-color: #2d3748; /* gray-700 */
            border-color: #e53e3e; /* red-600 */
            box-shadow: 0 0 0 3px rgba(229, 62, 62, 0.4);
            outline: none;
        }
        .form-label {
            color: #cbd5e0; /* gray-400 */
        }
    </style>
</head>
<body class="bg-gray-950 min-h-screen flex items-center justify-center p-6">

    <div class="bg-gray-900 p-8 rounded-lg shadow-xl w-full max-w-2xl border-t-4 border-red-600">
        
        <div class="mb-6 text-left">
            <h1 class="text-3xl font-bold">
                <span class="text-green-500">Echoes</span>
                <span class="text-gray-100">of</span>
                <span class="text-red-600">Gaza</span><span class="text-gray-300">: a historical archive</span>
            </h1>
            
            <p class="text-gray-300 mt-4 text-left">
                This is a Gaza genocide collaborative. Submit articles that document the ongoing genocide, 
                ethnic cleansing, displacement, dehumanization, and subjugation of the Palestinian people.
            </p>
            <p class="text-gray-400 mt-3 text-left text-sm">
                <strong>Please note:</strong> This is an open-source project, but contributions are curated. 
                Only individuals with a history of acting in good faith towards Palestinian liberation 
                have been invited to this collective. Approval will still take place for any article 
                submitted to ensure it is aligned with the mission of Echoes of Gaza.
            </p>
            <p class="text-gray-300 mt-4 text-left">
                Thank you for contributing. Fill out the fields below and click "Submit" to create a new issue in the GitHub repository.
            </P>
        </div>

        <!-- Submission Form -->
        <form id="submissionForm">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Date -->
                <div>
                    <label for="date" class="form-label block text-sm font-medium mb-2">Date (YYYY-MM-DD) <span class="text-red-500">*</span></label>
                    <input type="date" id="date" name="date" class="form-input block w-full px-4 py-3 rounded-md shadow-sm transition duration-150 ease-in-out" required>
                </div>

                <!-- Source -->
                <div>
                    <label for="source" class="form-label block text-sm font-medium mb-2">Source (e.g., Al Jazeera, NYT) <span class="text-red-500">*</span></label>
                    <input type="text" id="source" name="source" placeholder="Al Jazeera" class="form-input block w-full px-4 py-3 rounded-md shadow-sm transition duration-150 ease-in-out" required>
                </div>
            </div>

            <!-- Title -->
            <div class="mt-6">
                <label for="title" class="form-label block text-sm font-medium mb-2">Article Title <span class="text-red-500">*</span></label>
                <input type="text" id="title" name="title" placeholder="Full, exact article title" class="form-input block w-full px-4 py-3 rounded-md shadow-sm transition duration-150 ease-in-out" required>
            </div>

            <!-- URL -->
            <div class="mt-6">
                <label for="link" class="form-label block text-sm font-medium mb-2">Article URL <span class="text-red-500">*</span></label>
                <input type="url" id="link" name="link" placeholder="https://..." class="form-input block w-full px-4 py-3 rounded-md shadow-sm transition duration-150 ease-in-out" required>
            </div>
            
            <!-- Category Dropdown -->
            <div class="mt-6">
                <label for="category" class="form-label block text-sm font-medium mb-2">Category <span class="text-red-500">*</span></label>
                <select id="category" name="category" class="form-select block w-full px-4 py-3 rounded-md shadow-sm transition duration-150 ease-in-out" required>
                    <option value="" disabled selected>Select a category...</option>
                    <!-- Options will be populated by JavaScript -->
                </select>
            </div>

            <!-- Neutral Summary (Optional) -->
            <div class="mt-6">
                <label for="summary" class="form-label block text-sm font-medium mb-2">Neutral Summary (Optional)</label>
                <textarea id="summary" name="summary" rows="4" placeholder="A brief, 1-2 sentence neutral summary of the article's content." class="form-input block w-full px-4 py-3 rounded-md shadow-sm transition duration-150 ease-in-out"></textarea>
            </div>

            <!-- Image URL (Optional) -->
            <div class="mt-6">
                <label for="imageUrl" class="form-label block text-sm font-medium mb-2">Image URL (Optional)</label>
                <input type="url" id="imageUrl" name="imageUrl" placeholder="Direct link to a relevant image (https://...)" class="form-input block w-full px-4 py-3 rounded-md shadow-sm transition duration-150 ease-in-out">
            </div>

            <!-- Submit Button -->
            <div class="mt-8">
                <button type="submit" class="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-lg font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition duration-150 ease-in-out">
                    Submit Article
                </button>
            </div>
        </form>
    </div>

    <script>
        // --- Category Data ---
        // Cleaned and alphabetized list of categories
        const categories = [
            "Accountability", "Aid Access", "Aid Blockade", "Aid Conflict", "Aid Crisis", 
            "Aid Disruption", "Aid Policy", "Aid Targeting", "Analysis", "Antisemitism", 
            "Civilian Casualties", "Conflict", "Conflict / Human Stories", "Conflict / Humanitarian", 
            "Conflict Reporting", "Conflict and Destruction", "Conflict and Displacement", 
            "Conflict escalation", "Crisis", "Culture", "Death Toll", "Destruction Plans", 
            "Detention & Rights", "Diplomacy", "Economic Crisis", "Environment", "Ethnic Cleansing", 
            "Extreme Rhetoric", "Famine crisis", "Forced Displacement", "Foreign Policy", 
            "Gaza Policy", "Genocide", "Genocide Accusations", "Genocide Allegation", 
            "Genocide Allegations", "Genocide Analysis", "Health", "Health / Starvation", 
            "Healthcare Crisis", "Hostage Testimony", "Human interest", "Human Rights", 
            "Human Shields", "Humanitarian", "Humanitarian Aid", "Humanitarian Crisis", 
            "Hunger Crisis", "Illegal Expansion", "Illegal Weaponry", "Incitement", 
            "Intelligence", "International Appeal", "Israeli Politics", "Legal", 
            "Legal Proceedings", "Living Conditions", "Media", "Media & Conflict", 
            "Media Coverage", "Media Ethics", "Media Restrictions", "Media Rights", 
            "Medical Testimony", "Military", "Military Criticism", "Military Operations", 
            "Military Plans", "Military Policy", "Military Technology", "Opinion", 
            "Opinion / Human Rights", "Political Controversy", "Political Criticism", 
            "Political Discourse", "Political Statements", "Politics", "Press Freedom", 
            "Prison Conditions", "Protests", "Psychological Warfare", "Public Opinion", 
            "Rhetoric", "Rights & Justice", "Rules of Engagement", "Security / Diplomacy", 
            "Settler Violence", "Sexual Violence", "Social Impact", "Sports", "Sports & Conflict", 
            "Starvation", "Starvation Warning", "Targeting Civilians", "Targeting Healthcare", 
            "Targeting Religious Sites", "Technology", "Transfer Support", "U.S. Politics", 
            "UN Reports", "UN Warnings", "War Crimes", "War Objectives", "West Bank Violence"
        ];

        // Color mapping function (consistent hash)
        function getCategoryColor(category) {
            const colors = [
                "#EF4444", // red-500
                "#F97316", // orange-500
                "#F59E0B", // amber-500
                "#EAB308", // yellow-500
                "#84CC16", // lime-500
                "#22C55E", // green-500
                "#10B981", // emerald-500
                "#14B8A6", // teal-500
                "#06B6D4", // cyan-500
                "#0EA5E9", // sky-500
                "#3B82F6", // blue-500
                "#6366F1", // indigo-500
                "#8B5CF6", // violet-500
                "#A855F7", // purple-500
                "#D946EF", // fuchsia-500
                "#EC4899", // pink-500
                "#F43F5E"  // rose-500
            ];
            
            // Simple hash function to get a consistent color index
            let hash = 0;
            for (let i = 0; i < category.length; i++) {
                hash = (hash << 5) - hash + category.charCodeAt(i);
                hash = hash & hash; // Convert to 32bit integer
            }
            const index = Math.abs(hash) % colors.length;
            return colors[index];
        }

        // --- Populate Dropdown ---
        document.addEventListener('DOMContentLoaded', () => {
            const categorySelect = document.getElementById('category');
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                categorySelect.appendChild(option);
            });
        });

        // --- Form Submission ---
        document.getElementById('submissionForm').addEventListener('submit', function(e) {
            e.preventDefault();

            // 1. Get all form values
            const date = document.getElementById('date').value;
            const source = document.getElementById('source').value;
            const title = document.getElementById('title').value;
            const link = document.getElementById('link').value;
            const category = document.getElementById('category').value;
            const summary = document.getElementById('summary').value || ""; // Default to empty string
            const imageUrl = document.getElementById('imageUrl').value || "https://placehold.co/600x400/000000/FFFFFF?text=Echoes+of+Gaza"; // Default placeholder
            
            // 2. Get the corresponding color
            const categoryColor = getCategoryColor(category);

            // 3. Construct the GitHub Issue Title
            const issueTitle = `[${source}] ${title}`;

            // 4. Construct the JSON object for the body
            const jsonObject = {
                date,
                title,
                summary,
                link,
                imageUrl,
                category,
                categoryColor,
                source
            };

            // 5. Format the JSON as a string block
            const jsonString = JSON.stringify(jsonObject, null, 2);
            const issueBody = "```json\n" + jsonString + "\n```";

            // 6. Encode for URL
            const encodedTitle = encodeURIComponent(issueTitle);
            const encodedBody = encodeURIComponent(issueBody);

            // 7. Create the GitHub Issue URL
            const repoUrl = 'https://github.com/rscboy/eyes-on-palestine/issues/new';
            const finalUrl = `${repoUrl}?title=${encodedTitle}&body=${encodedBody}`;

            // 8. Open in a new tab
            window.open(finalUrl, '_blank');
        });
    </script>
</body>
</html>
